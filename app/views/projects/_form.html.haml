= form_with model: @project, local: true, id: 'project_form' do |f|
  = render 'notifications/error_messages', object: f.object

  .grid-x
    .cell
      .field
        = f.label :name
        = f.text_field :name
  .grid-x
    .cell
      .field
        = f.label :tracks
        = f.file_field :tracks, multiple: true, direct_upload: true
  .grid-x
    .medium-6.cell
      .actions
        = f.submit class: 'button'
  .grid-x
    - if f.object.tracks.attached? && f.object.valid?
      - f.object.tracks.each do |track|
        .cell
          %div{id: "track_#{track.id}"}
            .grid-x
              .small-10.medium-6.large-5.cell
                .bar
                  = link_to rails_blob_path(track, disposition: :attachment),
                  title: 'Download', id: "download_link_#{track.id}",
                  data: { project: @project.id, track: track.id } do
                    = display_track(track)
                  = link_to project_track_path(f.object, track),
                  remote: true, method: :delete do
                    = fa_icon('trash', class: 'remove_link', title: 'Remove')
              .small-2.medium-6.large-7.cell
                %div{class: "download_status_#{track.id}"}
                  - if @project.downloaded_tracks.find_by(track_id: track.id)
                    = fa_icon 'cloud-download-alt', class: 'downloaded', title: 'Downloaded'
